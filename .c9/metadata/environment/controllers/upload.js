{"filter":false,"title":"upload.js","tooltip":"/controllers/upload.js","undoManager":{"mark":3,"position":3,"stack":[[{"start":{"row":0,"column":0},"end":{"row":60,"column":2},"action":"insert","lines":["const uploadFile = require(\"../middleware/upload\");","","const upload = async (req, res) => {","  try {","    await uploadFile(req, res);","","    if (req.file == undefined) {","      return res.status(400).send({ message: \"Please upload a file!\" });","    }","","    res.status(200).send({","      message: \"Uploaded the file successfully: \" + req.file.originalname,","    });","  } catch (err) {","    res.status(500).send({","      message: `Could not upload the file: ${req.file.originalname}. ${err}`,","    });","  }","};","","const getListFiles = (req, res) => {","  const directoryPath = __basedir + \"/resources/static/assets/uploads/\";","","  fs.readdir(directoryPath, function (err, files) {","    if (err) {","      res.status(500).send({","        message: \"Unable to scan files!\",","      });","    }","","    let fileInfos = [];","","    files.forEach((file) => {","      fileInfos.push({","        name: file,","        url: baseUrl + file,","      });","    });","","    res.status(200).send(fileInfos);","  });","};","","const download = (req, res) => {","  const fileName = req.params.name;","  const directoryPath = __basedir + \"/resources/static/assets/uploads/\";","","  res.download(directoryPath + fileName, fileName, (err) => {","    if (err) {","      res.status(500).send({","        message: \"Could not download the file. \" + err,","      });","    }","  });","};","","module.exports = {","  upload,","  getListFiles,","  download,","};"],"id":1}],[{"start":{"row":0,"column":31},"end":{"row":0,"column":41},"action":"remove","lines":["middleware"],"id":2},{"start":{"row":0,"column":31},"end":{"row":0,"column":32},"action":"insert","lines":["d"]},{"start":{"row":0,"column":32},"end":{"row":0,"column":33},"action":"insert","lines":["i"]},{"start":{"row":0,"column":33},"end":{"row":0,"column":34},"action":"insert","lines":["s"]},{"start":{"row":0,"column":34},"end":{"row":0,"column":35},"action":"insert","lines":["p"]}],[{"start":{"row":0,"column":34},"end":{"row":0,"column":35},"action":"remove","lines":["p"],"id":3}],[{"start":{"row":0,"column":34},"end":{"row":0,"column":35},"action":"insert","lines":["t"],"id":4}],[{"start":{"row":0,"column":36},"end":{"row":0,"column":42},"action":"remove","lines":["upload"],"id":5},{"start":{"row":0,"column":36},"end":{"row":0,"column":37},"action":"insert","lines":["f"]},{"start":{"row":0,"column":37},"end":{"row":0,"column":38},"action":"insert","lines":["i"]},{"start":{"row":0,"column":38},"end":{"row":0,"column":39},"action":"insert","lines":["l"]},{"start":{"row":0,"column":39},"end":{"row":0,"column":40},"action":"insert","lines":["e"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":59,"column":11},"end":{"row":59,"column":11},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1603936245311,"hash":"a1891ef3b251b3616efb08be9dd1229d42e453d1"}