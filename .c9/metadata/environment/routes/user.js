{"filter":false,"title":"user.js","tooltip":"/routes/user.js","undoManager":{"mark":77,"position":77,"stack":[[{"start":{"row":7,"column":0},"end":{"row":8,"column":0},"action":"remove","lines":["",""],"id":2},{"start":{"row":6,"column":48},"end":{"row":7,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":6,"column":48},"end":{"row":7,"column":0},"action":"insert","lines":["",""],"id":3}],[{"start":{"row":8,"column":19},"end":{"row":9,"column":0},"action":"insert","lines":["",""],"id":4}],[{"start":{"row":10,"column":0},"end":{"row":10,"column":1},"action":"insert","lines":["/"],"id":5},{"start":{"row":10,"column":1},"end":{"row":10,"column":2},"action":"insert","lines":["/"]}],[{"start":{"row":10,"column":2},"end":{"row":10,"column":3},"action":"insert","lines":[" "],"id":6},{"start":{"row":10,"column":3},"end":{"row":10,"column":4},"action":"insert","lines":["ㅐ"]},{"start":{"row":10,"column":4},"end":{"row":10,"column":5},"action":"insert","lines":["ㅔ"]},{"start":{"row":10,"column":5},"end":{"row":10,"column":6},"action":"insert","lines":["ㄷ"]},{"start":{"row":10,"column":5},"end":{"row":10,"column":6},"action":"remove","lines":["ㄷ"]},{"start":{"row":10,"column":4},"end":{"row":10,"column":5},"action":"remove","lines":["ㅔ"]},{"start":{"row":10,"column":3},"end":{"row":10,"column":4},"action":"remove","lines":["ㅐ"]}],[{"start":{"row":10,"column":3},"end":{"row":10,"column":4},"action":"insert","lines":["o"],"id":7},{"start":{"row":10,"column":4},"end":{"row":10,"column":5},"action":"insert","lines":["p"]},{"start":{"row":10,"column":5},"end":{"row":10,"column":6},"action":"insert","lines":["e"]},{"start":{"row":10,"column":6},"end":{"row":10,"column":7},"action":"insert","lines":["n"]}],[{"start":{"row":10,"column":7},"end":{"row":10,"column":8},"action":"insert","lines":[" "],"id":8},{"start":{"row":10,"column":8},"end":{"row":10,"column":9},"action":"insert","lines":["p"]},{"start":{"row":10,"column":9},"end":{"row":10,"column":10},"action":"insert","lines":["r"]},{"start":{"row":10,"column":10},"end":{"row":10,"column":11},"action":"insert","lines":["o"]},{"start":{"row":10,"column":11},"end":{"row":10,"column":12},"action":"insert","lines":["c"]},{"start":{"row":10,"column":12},"end":{"row":10,"column":13},"action":"insert","lines":["e"]},{"start":{"row":10,"column":13},"end":{"row":10,"column":14},"action":"insert","lines":["s"]},{"start":{"row":10,"column":14},"end":{"row":10,"column":15},"action":"insert","lines":["s"]}],[{"start":{"row":22,"column":0},"end":{"row":219,"column":9},"action":"remove","lines":["// user","// router.route('/')","  // GET Method","  // .get(function(req, res) {","    // console.log(`>>>>>>>>>> url :  ${req.method}  ||  ${req.originalUrl}`);","    ","    // const param = [utils.uk(req.param(\"name\")), utils.uk(req.param(\"pw\")), utils.uk(req.param(\"email\")), utils.uk(req.param(\"phone\"))];","    ","    // models.find({","    //   where : {","    //     [Op.or]: [","    //       {name: req.param(\"name\")}, ","    //       {email: req.param(\"email\")}, ","    //       {phone: req.param(\"phone\")}]","    //   }","    // })","    // .then( user => {","    //   console.log(\"success ...\");","    //   console.log(user);","    //   return res.status(200).send({success: true, message: 'success', code: 200, user:user});          ","    // }).catch( err => {","    //   console.log(\"error ...\");","    //   console.log(err);","    //   return res.status(500).send({success: false, message: err.code, code: 500, user : {}});      ","    // });","    ","    // connection.query({","    //   sql: 'SELECT * FROM user WHERE name = ? OR email = ? OR phone = ? LIMIT 1;',","    //   timeout: 40000, // 40s","    //   values: param","    // }, ","    // function (error, rows, fields) {","    //   if (error) return res.status(500).send({success: false, message: error.code, code: 500, user : {}});","    //   if(rows.length > 0)","    //     return res.status(200).send({success: true, message: 'success', code: 200, user:rows[0]});    ","    //   else ","    //     return res.status(900).send({success: true, message: '조결과가 없습니다.', code: 900, user:{}});    ","    // });","  // })","  // POST Method","  // .post(function(req, res) {","  //   console.log(`>>>>>>>>>> url :  ${req.method}  ||  ${req.originalUrl}`);","  //   const param = [utils.uk(req.param(\"name\")), utils.uk(req.param(\"pw\")), utils.uk(req.param(\"email\")), utils.uk(req.param(\"phone\"))];","  //   let emptyValue = \"\";","    ","  //   param.forEach(function(v, k) {","  //     if(v == \"\" && k == 0) emptyValue = \"name\";","  //     else if(v == \"\" && k == 1) emptyValue = \"pw\";","  //     else if(v == \"\" && k == 2) emptyValue = \"email\";","  //     else if(v == \"\" && k == 3) emptyValue = \"phone\";;","  //   });","    ","  //   // 회원가입에 필요한 데이터 전달받지 못함","  //   if(utils.uk(emptyValue) != \"\"){","  //     console.log(\">> 회원가입에 필요한 데이터 전달받지 못함\");","  //     return res.status(500).send({success: false, message: 'undefined ' + emptyValue, code: 500, user:{}});","  //   } else {","  //     // 중복 회원 확인","  //     // let query = connection.query('SELECT COUNT(*) AS count FROM user WHERE email = ? OR phone = ?;', [utils.uk(req.param(\"email\")), utils.uk(req.param(\"phone\"))]);","      ","      ","  //     connection.query({","  //       sql: 'SELECT COUNT(*) AS count FROM user WHERE email = ? OR phone = ?;',","  //       timeout: 40000, // 40s","  //       values: [utils.uk(req.param(\"email\")), utils.uk(req.param(\"phone\"))]","  //     }, ","  //     function (error, rows, fields) {","  //       // 중복 조회 �����패","  //       if (error) {","  //         console.log(\">> 중복 조회 실패\");","  //         console.log(error);","  //         return res.status(500).send({success: false, message: error.code, code: 500, user : {}});","  //       }","  //       // 중복 조회 결과  ","  //       if(rows[0].count < 1){","  //         console.log(\">> 가입된 회원 없음\");","  //         // 암호화","  //         let key  = utils.pbkdf2AsyncNonSalt(crypto, req.param('pw'));","  //         key.then((successMessage) => {","  //           let insertValue = [req.param('name'), successMessage.key, req.param('email'), req.param('phone'), successMessage.salt];","  //           connection.query({","  //             sql: 'INSERT INTO user(name, pw, email, phone, salt) VALUES (?, ?, ?, ?, ?)',","  //             timeout: 40000, // 40s","  //             values: insertValue","  //           }, ","  //           function (error, rows, fields) {","  //             // 회원가입 실패","  //             if(error) {","  //               console.log(\">> 회원가입 실패\");","  //               return res.status(500).send({success: false, message: error.code, code: 500, user:{}});  ","  //             }","  //             // 회원가입 성공","  //             console.log(\">> 회원가입 성공\");","  //             return res.status(200).send({success: true, message: '���원가입 성공', code: 200, user:rows[0]});","  //           });","  //         });","  //       }","  //       // 가입된 회원이 있음","  //       else {","  //         console.log(\">> 가입된 회원이 있음\");","  //         return res.status(900).send({success: false, message: '이미 가입된 회원이 있습니다.', code: 900, user:param});","  //       }","  //     });","  //   }","  // })","//   // PUT Method","//   .put(function(req, res) {","//     console.log(`>>>>>>>>>> url :  ${req.method}  ||  ${req.originalUrl}`);","//     res.send('Update the book');","//   })","//   // DELETE Method","//   .delete(function(req, res) {","//     console.log(`>>>>>>>>>> url :  ${req.method}  ||  ${req.originalUrl}`);","//     res.send('Delte the book');","//   });","  ","  ","  ","// router.route('/signin')","//   .get((req, res) => {","//     console.log(`>>>>>>>>>> url :  ${req.method}  ||  ${req.originalUrl}`);","//     const param = [utils.uk(req.param(\"email\"))];","//     connection.query({","//       sql: 'SELECT * FROM user WHERE email = ?;',","//       timeout: 40000, // 40s","//       values: param","//     },","//     function (error, rows, fields) {","//       if (error) return res.status(500).send({success: false, message: error.code, code: 500, user : {}});","      ","//       if(rows.length > 0){","//         let pw = req.param('pw');","//         let salt = rows[0].salt;","        ","//         console.log(\">>>>> salt\");","//         console.log(salt);","//         console.log(\">>>>> pw\");","//         console.log(pw);","//         let key  = utils.pbkdf2Async(crypto, salt, pw);","        ","//         key.then((successMessage) => {","          ","//           console.log(\"rows\");","//           console.log(rows[0]);","//           console.log(\"salt\");","//           console.log(rows[0].salt);","//           console.log(\"DB pw\");","//           console.log(rows[0].pw);","//           console.log(\"req pw\");","//           console.log(successMessage.key);","          ","//           if(successMessage.key == rows[0].pw)","//             return res.status(200).send({success: true, message: 'success', code: 200, data: {result : successMessage}});","//           else","//             return res.status(900).send({success: true, message: '비밀번호가 틀렸습니다.', code: 900, data: {}});","//         });","//       } else {","//         return res.status(901).send({success: true, message: '아이디가 틀렸습니다.', code: 901, data: {}});","//       }","//     });","//   });","  ","","// // router.get('/cryptoTest', function(req, res, next) {","// //   console.log(`>>>>>>>>>> url :  ${req.method}  ||  ${req.originalUrl}`);","","// //   crypto.randomBytes(64, (err, buf) => {","// //     crypto.pbkdf2(req.param('pw'), buf.toString('base64'), 100000, 64, 'sha512', (err, key) => {","      ","// //       let salt = buf.toString('base64');","// //       let pw = key.toString('base64');","      ","// //       console.log(`salt : ${salt}`);","// //       console.log(`pw : ${pw}`); // 'dWhPkH6c4X1Y71A/DrAHhML3DyKQdEkUOIaSmYCI7xZkD5bLZhPF0dOSs2YZA/Y4B8XNfWd3DHIqR5234RtHzw=='","    ","// //       return res.status(200).send({","// //         success: true, ","// //         message: 'success', ","// //         code: 200,","// //         data: {","// //           salt:salt,","// //           pw:pw","// //         }","// //       }); ","// //     });","// //   });","  ","// // });","// // router.post('/cryptoTest', function(req, res, next) {","// //   console.log(`>>>>>>>>>> url :  ${req.method}  ||  ${req.originalUrl}`);","// //   let salt = req.param('salt');","// //   let pw   = req.param('pw');","// //   let key  = utils.pbkdf2Async(crypto, salt, pw);","  ","// //   key.then((successMessage) => {","// //     return res.status(200).send({success: true, message: 'success', code: 200, data: {result : successMessage}});","// //   });","// // });"],"id":9},{"start":{"row":21,"column":0},"end":{"row":22,"column":0},"action":"remove","lines":["",""]},{"start":{"row":20,"column":0},"end":{"row":21,"column":0},"action":"remove","lines":["",""]},{"start":{"row":19,"column":84},"end":{"row":20,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":12,"column":62},"end":{"row":13,"column":0},"action":"insert","lines":["",""],"id":10}],[{"start":{"row":13,"column":0},"end":{"row":13,"column":62},"action":"insert","lines":["router.post(    '/', userController.add);             // 회원 가입"],"id":11}],[{"start":{"row":13,"column":18},"end":{"row":13,"column":24},"action":"insert","lines":["Social"],"id":12}],[{"start":{"row":13,"column":18},"end":{"row":13,"column":19},"action":"remove","lines":["S"],"id":13}],[{"start":{"row":13,"column":18},"end":{"row":13,"column":19},"action":"insert","lines":["ㅣ"],"id":14},{"start":{"row":13,"column":18},"end":{"row":13,"column":19},"action":"remove","lines":["ㅣ"]}],[{"start":{"row":13,"column":18},"end":{"row":13,"column":19},"action":"insert","lines":["s"],"id":15}],[{"start":{"row":13,"column":42},"end":{"row":13,"column":48},"action":"insert","lines":["Social"],"id":17}],[{"start":{"row":13,"column":42},"end":{"row":13,"column":43},"action":"remove","lines":["S"],"id":18}],[{"start":{"row":13,"column":42},"end":{"row":13,"column":43},"action":"insert","lines":["s"],"id":19}],[{"start":{"row":13,"column":48},"end":{"row":13,"column":49},"action":"remove","lines":["a"],"id":20}],[{"start":{"row":13,"column":48},"end":{"row":13,"column":49},"action":"insert","lines":["A"],"id":21}],[{"start":{"row":13,"column":64},"end":{"row":13,"column":66},"action":"remove","lines":["  "],"id":22},{"start":{"row":13,"column":62},"end":{"row":13,"column":64},"action":"remove","lines":["  "]},{"start":{"row":13,"column":60},"end":{"row":13,"column":62},"action":"remove","lines":["  "]},{"start":{"row":13,"column":58},"end":{"row":13,"column":60},"action":"remove","lines":["  "]},{"start":{"row":13,"column":56},"end":{"row":13,"column":58},"action":"remove","lines":["  "]},{"start":{"row":13,"column":54},"end":{"row":13,"column":56},"action":"remove","lines":["  "]}],[{"start":{"row":13,"column":0},"end":{"row":13,"column":62},"action":"remove","lines":["router.post(    '/social', userController.socialAdd); // 회원 가입"],"id":23}],[{"start":{"row":12,"column":62},"end":{"row":13,"column":0},"action":"remove","lines":["",""],"id":24}],[{"start":{"row":13,"column":63},"end":{"row":14,"column":0},"action":"insert","lines":["",""],"id":25}],[{"start":{"row":14,"column":0},"end":{"row":14,"column":62},"action":"insert","lines":["router.post(    '/social', userController.socialAdd); // 회원 가입"],"id":26}],[{"start":{"row":14,"column":62},"end":{"row":15,"column":0},"action":"insert","lines":["",""],"id":27}],[{"start":{"row":15,"column":0},"end":{"row":15,"column":62},"action":"insert","lines":["router.post(    '/social', userController.socialAdd); // 회원 가입"],"id":28}],[{"start":{"row":15,"column":24},"end":{"row":15,"column":25},"action":"insert","lines":["-"],"id":29},{"start":{"row":15,"column":25},"end":{"row":15,"column":26},"action":"insert","lines":["l"]},{"start":{"row":15,"column":26},"end":{"row":15,"column":27},"action":"insert","lines":["o"]},{"start":{"row":15,"column":27},"end":{"row":15,"column":28},"action":"insert","lines":["g"]},{"start":{"row":15,"column":28},"end":{"row":15,"column":29},"action":"insert","lines":["i"]},{"start":{"row":15,"column":29},"end":{"row":15,"column":30},"action":"insert","lines":["n"]}],[{"start":{"row":11,"column":54},"end":{"row":11,"column":56},"action":"insert","lines":["  "],"id":30}],[{"start":{"row":11,"column":56},"end":{"row":11,"column":60},"action":"insert","lines":["    "],"id":31}],[{"start":{"row":12,"column":54},"end":{"row":12,"column":56},"action":"insert","lines":["  "],"id":32}],[{"start":{"row":12,"column":56},"end":{"row":12,"column":60},"action":"insert","lines":["    "],"id":33}],[{"start":{"row":13,"column":54},"end":{"row":13,"column":56},"action":"insert","lines":["  "],"id":34}],[{"start":{"row":13,"column":56},"end":{"row":13,"column":60},"action":"insert","lines":["    "],"id":35}],[{"start":{"row":14,"column":54},"end":{"row":14,"column":56},"action":"insert","lines":["  "],"id":36}],[{"start":{"row":14,"column":56},"end":{"row":14,"column":60},"action":"insert","lines":["    "],"id":37}],[{"start":{"row":14,"column":63},"end":{"row":14,"column":64},"action":"insert","lines":["t"],"id":38}],[{"start":{"row":14,"column":63},"end":{"row":14,"column":64},"action":"remove","lines":["t"],"id":39}],[{"start":{"row":14,"column":63},"end":{"row":14,"column":64},"action":"insert","lines":["소"],"id":40}],[{"start":{"row":14,"column":64},"end":{"row":14,"column":66},"action":"insert","lines":["셜 "],"id":41}],[{"start":{"row":15,"column":63},"end":{"row":15,"column":64},"action":"insert","lines":["소"],"id":42}],[{"start":{"row":15,"column":64},"end":{"row":15,"column":66},"action":"insert","lines":["셜 "],"id":43}],[{"start":{"row":15,"column":7},"end":{"row":15,"column":11},"action":"remove","lines":["post"],"id":44},{"start":{"row":15,"column":7},"end":{"row":15,"column":11},"action":"insert","lines":["post"]},{"start":{"row":15,"column":7},"end":{"row":15,"column":11},"action":"remove","lines":["post"]},{"start":{"row":15,"column":7},"end":{"row":15,"column":8},"action":"insert","lines":["ㅎ"]},{"start":{"row":15,"column":7},"end":{"row":15,"column":8},"action":"remove","lines":["ㅎ"]},{"start":{"row":15,"column":7},"end":{"row":15,"column":8},"action":"insert","lines":["ㅎ"]},{"start":{"row":15,"column":8},"end":{"row":15,"column":9},"action":"insert","lines":["ㄷ"]},{"start":{"row":15,"column":9},"end":{"row":15,"column":10},"action":"insert","lines":["ㅅ"]},{"start":{"row":15,"column":9},"end":{"row":15,"column":10},"action":"remove","lines":["ㅅ"]},{"start":{"row":15,"column":8},"end":{"row":15,"column":9},"action":"remove","lines":["ㄷ"]},{"start":{"row":15,"column":7},"end":{"row":15,"column":8},"action":"remove","lines":["ㅎ"]}],[{"start":{"row":15,"column":7},"end":{"row":15,"column":8},"action":"insert","lines":["g"],"id":45},{"start":{"row":15,"column":8},"end":{"row":15,"column":9},"action":"insert","lines":["e"]},{"start":{"row":15,"column":9},"end":{"row":15,"column":10},"action":"insert","lines":["t"]}],[{"start":{"row":15,"column":47},"end":{"row":15,"column":56},"action":"remove","lines":["socialAdd"],"id":46},{"start":{"row":15,"column":47},"end":{"row":15,"column":58},"action":"insert","lines":["socialLogin"]}],[{"start":{"row":11,"column":60},"end":{"row":11,"column":64},"action":"insert","lines":["    "],"id":47}],[{"start":{"row":12,"column":60},"end":{"row":12,"column":64},"action":"insert","lines":["    "],"id":48}],[{"start":{"row":13,"column":60},"end":{"row":13,"column":64},"action":"insert","lines":["    "],"id":49}],[{"start":{"row":14,"column":60},"end":{"row":14,"column":64},"action":"insert","lines":["    "],"id":50}],[{"start":{"row":15,"column":61},"end":{"row":15,"column":64},"action":"insert","lines":["   "],"id":51}],[{"start":{"row":15,"column":15},"end":{"row":15,"column":16},"action":"insert","lines":[" "],"id":52}],[{"start":{"row":15,"column":64},"end":{"row":15,"column":65},"action":"remove","lines":[" "],"id":53}],[{"start":{"row":11,"column":21},"end":{"row":11,"column":24},"action":"insert","lines":["   "],"id":54}],[{"start":{"row":11,"column":24},"end":{"row":11,"column":28},"action":"insert","lines":["    "],"id":55}],[{"start":{"row":11,"column":28},"end":{"row":11,"column":32},"action":"insert","lines":["    "],"id":56}],[{"start":{"row":12,"column":21},"end":{"row":12,"column":24},"action":"insert","lines":["   "],"id":57}],[{"start":{"row":12,"column":24},"end":{"row":12,"column":28},"action":"insert","lines":["    "],"id":58}],[{"start":{"row":12,"column":28},"end":{"row":12,"column":32},"action":"insert","lines":["    "],"id":59}],[{"start":{"row":13,"column":26},"end":{"row":13,"column":28},"action":"insert","lines":["  "],"id":60}],[{"start":{"row":13,"column":28},"end":{"row":13,"column":32},"action":"insert","lines":["    "],"id":61}],[{"start":{"row":14,"column":27},"end":{"row":14,"column":28},"action":"insert","lines":[" "],"id":62}],[{"start":{"row":14,"column":28},"end":{"row":14,"column":32},"action":"insert","lines":["    "],"id":63}],[{"start":{"row":14,"column":32},"end":{"row":14,"column":33},"action":"insert","lines":[" "],"id":64}],[{"start":{"row":13,"column":32},"end":{"row":13,"column":33},"action":"insert","lines":[" "],"id":65}],[{"start":{"row":12,"column":32},"end":{"row":12,"column":33},"action":"insert","lines":[" "],"id":66}],[{"start":{"row":11,"column":32},"end":{"row":11,"column":33},"action":"insert","lines":[" "],"id":67}],[{"start":{"row":18,"column":21},"end":{"row":18,"column":24},"action":"insert","lines":["   "],"id":68}],[{"start":{"row":18,"column":24},"end":{"row":18,"column":28},"action":"insert","lines":["    "],"id":69}],[{"start":{"row":19,"column":21},"end":{"row":19,"column":24},"action":"insert","lines":["   "],"id":70}],[{"start":{"row":19,"column":24},"end":{"row":19,"column":28},"action":"insert","lines":["    "],"id":71}],[{"start":{"row":20,"column":25},"end":{"row":20,"column":28},"action":"insert","lines":["   "],"id":72}],[{"start":{"row":20,"column":28},"end":{"row":20,"column":32},"action":"insert","lines":["    "],"id":73}],[{"start":{"row":20,"column":28},"end":{"row":20,"column":32},"action":"remove","lines":["    "],"id":74}],[{"start":{"row":21,"column":26},"end":{"row":21,"column":28},"action":"insert","lines":["  "],"id":75}],[{"start":{"row":8,"column":0},"end":{"row":8,"column":3},"action":"insert","lines":["// "],"id":76}],[{"start":{"row":8,"column":0},"end":{"row":8,"column":3},"action":"remove","lines":["// "],"id":77}],[{"start":{"row":8,"column":0},"end":{"row":8,"column":3},"action":"insert","lines":["// "],"id":78}],[{"start":{"row":20,"column":28},"end":{"row":20,"column":44},"action":"remove","lines":["utils.isLoggedin"],"id":79}],[{"start":{"row":20,"column":28},"end":{"row":20,"column":29},"action":"remove","lines":[","],"id":80},{"start":{"row":20,"column":28},"end":{"row":20,"column":29},"action":"remove","lines":[" "]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":20,"column":10},"end":{"row":20,"column":48},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1603034517530,"hash":"5cd754cfedcc228ce913110d8ac13ffd7542bc67"}